<!DOCTYPE html>
<html lang="ja" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>寝顔チェッカー for ポケモンスリープ</title>

  <!-- Google Fonts（やわらかめ） -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="assets/icons/pokemon_icons/pokemon_icons.js"></script>

<!-- 既存 -->
<!-- <script src="app.js" defer></script>
 
  <!-- 追加の軽いスタイル（必要なら既存style.cssに移動OK） -->
  <style>
    :root { --cell-checked-bg: rgba(13,110,253,.1); }
    body { font-family: "M PLUS Rounded 1c", system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", Meiryo, sans-serif; }
    .sticky-header th { position: sticky; top: 0; z-index: 1; }
    .cell-checked { background: var(--cell-checked-bg); }
    .cell-disabled { color: #6c757d; }
    .cell-absent { color: #adb5bd; } /* 存在しない寝顔（チェックボックス自体を出さない） */
  </style>

  <link rel="stylesheet" href="./style.css"><!-- あれば -->
</head>
<body>
  <header class="container py-3">
    <h1 class="h3 mb-0">寝顔チェッカー for ポケモンスリープ</h1>
  </header>

  <main class="container">
    <!-- Summary（タイトル行は削除） -->
    <section id="summary" class="mb-3">
      <div class="card">
        <div class="card-body">
          <div id="summaryGrid" class="table-responsive"><!-- JSで挿入 --></div>
        </div>
      </div>
    </section>

    <!-- Tabs -->
    <ul class="nav nav-tabs sticky-top bg-white pt-3" id="mainTabs" role="tablist" style="top:0;">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="tab-allfaces" data-bs-toggle="tab" data-bs-target="#pane-allfaces" type="button" role="tab">全寝顔チェックシート</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-byfield" data-bs-toggle="tab" data-bs-target="#pane-byfield" type="button" role="tab">フィールド別寝顔一覧</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-search" data-bs-toggle="tab" data-bs-target="#pane-search" type="button" role="tab">現在のフィールド・ランクから検索</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="tab-backup" data-bs-toggle="tab" data-bs-target="#pane-backup" type="button" role="tab">バックアップ・復旧</button>
      </li>
    </ul>

    <div class="tab-content pb-5" id="mainTabsContent">
      <!-- 全寝顔チェックシート -->
      <div class="tab-pane fade show active pt-3" id="pane-allfaces" role="tabpanel" aria-labelledby="tab-allfaces">
        <div class="card">
          <div class="card-body">
            <div class="row g-2 align-items-end mb-3">
              <div class="col-12 col-md-6">
                <label class="form-label">名前検索</label>
                <input id="searchName" class="form-control" placeholder="例）きも → キモリ / ヤルキモノ がヒット">
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">睡眠タイプ</label>
                <select id="filterStyle" class="form-select">
                  <option value="">すべて</option>
                  <option value="うとうと">うとうと</option>
                  <option value="すやすや">すやすや</option>
                  <option value="ぐっすり">ぐっすり</option>
                </select>
              </div>
              <div class="col-6 col-md-3">
                <label class="form-label">並び替え</label>
                <select id="sortBy" class="form-select">
                  <option value="no-asc">No昇順</option>
                  <option value="no-desc">No降順</option>
                  <option value="name-asc">名前昇順</option>
                  <option value="name-desc">名前降順</option>
                </select>
              </div>
            </div>

            <!-- 全体一括ON/OFF（確認ダイアログは維持） -->
            <div class="d-flex flex-wrap gap-2 mb-2">
              <button id="btnAllOn" class="btn btn-outline-primary btn-sm">すべて一括ON</button>
              <button id="btnAllOff" class="btn btn-outline-secondary btn-sm">すべて一括OFF</button>
              <span class="text-muted small ms-auto">※ 現在の絞り込み結果に対して適用</span>
            </div>

            <div class="table-responsive" id="allFacesTableWrap">
              <table class="table table-sm align-middle table-hover mb-0" id="allFacesTable">
<thead class="table-light sticky-header">
  <tr>
    <th style="min-width:72px;width:60px;">ポケモン</th>
    <th class="text-center" style="min-width:42px;">☆1</th>
    <th class="text-center" style="min-width:42px;">☆2</th>
    <th class="text-center" style="min-width:42px;">☆3</th>
    <th class="text-center" style="min-width:42px;">☆4</th>
    <th class="text-center" style="min-width:42px;">行まとめ</th>
  </tr>
</thead>
                <tbody><!-- JSで描画 --></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- フィールド別寝顔一覧 -->
      <div class="tab-pane fade pt-3" id="pane-byfield" role="tabpanel" aria-labelledby="tab-byfield">
        <div class="card">
          <div class="card-body">
            <ul class="nav nav-pills mb-3" id="fieldTabs" role="tablist"><!-- JS --></ul>
            <div class="tab-content" id="fieldTabsContent"><!-- JS --></div>
          </div>
        </div>
      </div>

      <!-- 現在のフィールド・ランクから検索 -->
      <div class="tab-pane fade pt-3" id="pane-search" role="tabpanel" aria-labelledby="tab-search">
        <div class="card">
          <div class="card-body">
            <div class="row g-2 align-items-end mb-3">
              <div class="col-12 col-md-6">
                <label class="form-label">フィールド</label>
                <select id="searchField" class="form-select"></select>
              </div>
              <div class="col-12 col-md-6">
                  <label class="form-label">ランク</label>
                  <select id="searchRank" class="form-select"></select>
              </div>
            </div>
            <p class="text-muted small mb-2">選択ランク以下で出現する「未入手」の寝顔のみ表示します。</p>
            <div class="table-responsive">
              <table class="table table-sm align-middle table-hover mb-0" id="rankSearchTable">
                <thead class="table-light sticky-header">
                  <tr>
                    <th>ポケモン</th>
                    <th>睡眠タイプ</th>
                    <th>レア度</th>
                    <th>必要ランク</th>
                  </tr>
                </thead>
                <tbody><!-- JSで描画 --></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- バックアップ・復旧 -->
      <div class="tab-pane fade pt-3" id="pane-backup" role="tabpanel" aria-labelledby="tab-backup">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap gap-2 mb-3">
              <button id="btnExport" class="btn btn-primary">エクスポート（JSON保存）</button>
              <label class="btn btn-outline-secondary mb-0">
                インポート（置換）
                <input id="fileImportReplace" type="file" accept="application/json" hidden>
              </label>
              <label class="btn btn-outline-secondary mb-0">
                インポート（マージ）
                <input id="fileImportMerge" type="file" accept="application/json" hidden>
              </label>
              <button id="btnReset" class="btn btn-danger ms-auto">すべて初期化</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="container py-4 text-center text-muted small">
    &copy; 2025 寝顔チェッカー（非公式ファンツール）
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./app.js" defer></script>
</body>
</html>
